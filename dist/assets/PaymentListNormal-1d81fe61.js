import{r as n,j as d,F as $,a as t,b as I}from"./index-ddd0bdee.js";import{h as L}from"./html2pdf-1c95f139.js";import j from"./MessagesList-060b5a96.js";import{N as k,F as E}from"./Footer-809c793e.js";import"./createLucideIcon-1a266af8.js";const R=5,H=()=>{const[u,N]=n.useState([]),[i,g]=n.useState([]),[w,y]=n.useState(!1),[l,v]=n.useState(""),[o,x]=n.useState(1),[S,_]=n.useState(0),p=e=>{const a=`; ${document.cookie}`.split(`; ${e}=`);return a.length===2?a.pop().split(";").shift():null},h=p("access"),b=p("user_id"),f=async(e=1)=>{if(b){y(!0);try{const a=(await I.get(`#${b}/`,{headers:h?{Authorization:`Bearer ${h}`}:{},withCredentials:!0})).data||[];N(a),g(a),_(a.length),x(e)}catch(r){console.error("Error fetching payments:",r),alert("Failed to fetch payments. Check console for details.")}finally{y(!1)}}};n.useEffect(()=>{f()},[h]),n.useEffect(()=>{g(u.filter(e=>(e.order_id||"").toLowerCase().includes(l.toLowerCase())||(e.payment_id||"").toLowerCase().includes(l.toLowerCase())))},[l,u]);const P=()=>{const e=[["ID","Order ID","Payment ID","Amount","Status","Refund ID","Refund Status","Created At"],...i.map(s=>[s.id,s.order_id,s.payment_id||"-",s.amount,s.status,s.refund_id||"-",s.refund_status||"-",new Date(s.created_at).toLocaleString()])].map(s=>s.map(D=>`"${D}"`).join(",")).join(`
`),r=new Blob([e],{type:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(r),a.download="Payments_Table.csv",a.click()},C=()=>{const e=document.createElement("table");e.innerHTML=`
      <thead>
        <tr>
          <th>ID</th><th>Order ID</th><th>Payment ID</th><th>Amount</th><th>Status</th>
          <th>Refund ID</th><th>Refund Status</th><th>Created At</th>
        </tr>
      </thead>
      <tbody>
        ${i.map(r=>`
          <tr>
            <td>${r.id}</td>
            <td>${r.order_id}</td>
            <td>${r.payment_id||"-"}</td>
            <td>${r.amount}</td>
            <td>${r.status}</td>
            <td>${r.refund_id||"-"}</td>
            <td>${r.refund_status||"-"}</td>
            <td>${new Date(r.created_at).toLocaleString()}</td>
          </tr>
        `).join("")}
      </tbody>
    `,L().set({margin:10,filename:"Payments_Table.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"pt",format:"a4",orientation:"landscape"}}).from(e).save()},c=Math.ceil(S/R),m=e=>{e<1||e>c||(x(e),f(e))};return d($,{children:[t(k,{}),t("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 py-12 px-6",children:d("div",{className:"max-w-7xl mx-auto",children:[t("h2",{className:"text-3xl font-semibold text-white mb-6 border-b pb-2 border-indigo-500",children:"Payment History"}),d("div",{className:"flex flex-col sm:flex-row sm:justify-between items-start sm:items-center gap-4 mb-6",children:[t("input",{type:"text",placeholder:"Search payments...",className:"w-full sm:w-64 px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-slate-900 text-white placeholder-gray-400",value:l,onChange:e=>v(e.target.value)}),d("div",{className:"flex gap-2",children:[t("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",onClick:P,children:"Export CSV"}),t("button",{className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",onClick:C,children:"Export PDF"})]})]}),t("div",{className:"overflow-x-auto bg-slate-900 rounded-lg shadow-lg",children:d("table",{className:"w-full text-left border-collapse",children:[d("thead",{className:"bg-indigo-600 text-gray-100",children:[" ",d("tr",{children:[t("th",{className:"px-4 py-2 border-r border-indigo-500 text-gray-800",children:"ID"}),t("th",{className:"px-4 py-2 border-r border-indigo-500 text-gray-800",children:"Order ID"}),t("th",{className:"px-4 py-2 border-r border-indigo-500 text-gray-800",children:"Payment ID"}),t("th",{className:"px-4 py-2 border-r border-indigo-500 text-gray-800",children:"Amount"}),t("th",{className:"px-4 py-2 border-r border-indigo-500 text-gray-800",children:"Status"}),t("th",{className:"px-4 py-2 border-r border-indigo-500 text-gray-800",children:"Refund ID"}),t("th",{className:"px-4 py-2 border-r border-indigo-500 text-gray-800",children:"Refund Status"}),t("th",{className:"px-4 py-2 text-gray-800",children:"Created At"})]})]}),t("tbody",{children:w?t("tr",{children:t("td",{colSpan:8,className:"text-center py-4 text-gray-200",children:"Loading..."})}):i.length===0?t("tr",{children:t("td",{colSpan:8,className:"text-center py-4 text-gray-400",children:"No records found"})}):i.map((e,r)=>d("tr",{className:"border-b border-gray-700 hover:bg-gray-800",children:[t("td",{className:"px-4 py-2 text-gray-100",children:e.id}),t("td",{className:"px-4 py-2 text-gray-100",children:e.order_id}),t("td",{className:"px-4 py-2 text-gray-100",children:e.payment_id||"-"}),t("td",{className:"px-4 py-2 text-gray-100",children:e.amount}),t("td",{className:"px-4 py-2 text-gray-100",children:e.status}),t("td",{className:"px-4 py-2 text-gray-100",children:e.refund_id||"-"}),t("td",{className:"px-4 py-2 text-gray-100",children:e.refund_status||"-"}),t("td",{className:"px-4 py-2 text-gray-100",children:new Date(e.created_at).toLocaleString()})]},r))})]})}),c>1&&d("div",{className:"flex justify-center mt-6 gap-2 flex-wrap",children:[t("button",{className:"px-3 py-1 border rounded text-white border-indigo-500 hover:bg-indigo-600 disabled:opacity-50",disabled:o===1,onClick:()=>m(o-1),children:"Prev"}),Array.from({length:c},(e,r)=>r+1).map(e=>t("button",{className:`px-3 py-1 border rounded text-white ${o===e?"bg-indigo-600 border-indigo-600":"border-indigo-500 hover:bg-indigo-600"}`,onClick:()=>m(e),children:e},e)),t("button",{className:"px-3 py-1 border rounded text-white border-indigo-500 hover:bg-indigo-600 disabled:opacity-50",disabled:o===c,onClick:()=>m(o+1),children:"Next"})]}),t(j,{})]})}),t(E,{})]})};export{H as default};
