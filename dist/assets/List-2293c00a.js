import{c as j,r,s as F,j as n,a as o,L as G,N as I,t as O,b as L}from"./index-4f69de9b.js";import{N as _}from"./index-a9f99864.js";import{s as C}from"./sortBy-36065db1.js";import{I as A}from"./IconTrashLines-dc34747a.js";import{I as H}from"./IconPlus-c84de4cf.js";import{F as Y,z as $}from"./index-abe6fa5d.js";import"./floating-ui.dom.browser.min-41a73232.js";import"./_baseIsEqual-5562a550.js";import"./_defineProperty-34184b92.js";const ee=()=>{const R=j(),[u,N]=r.useState([]),[S,p]=r.useState(1),E=[10,20,30,50,100],[c,D]=r.useState(E[0]),[h,f]=r.useState([]),[k,l]=r.useState([]),[g,x]=r.useState([]),[i,y]=r.useState(""),[b,z]=r.useState({columnAccessor:"invoice",direction:"asc"});r.useEffect(()=>{R(F("Invoice List"))},[R]);const B={USD:"$","USD - US Dollar":"$","GBP - British Pound":"£","IDR - Indonesian Rupiah":"Rp","INR - Indian Rupee":"₹","BRL - Brazilian Real":"R$","EUR - Germany (Euro)":"€","TRY - Turkish Lira":"₺"},T=async()=>{try{const a=((await L.get("https://cybitbackend.onrender.com/api/estimation")).data.invoices||[]).map(s=>{var d,m;const v=s.items.reduce((w,U)=>w+U.amount,0);return{id:s._id,invoice:s.invoiceNumber,name:((d=s.billing)==null?void 0:d.name)||"N/A",email:((m=s.billing)==null?void 0:m.email)||"N/A",date:s.invoiceDate?new Date(s.invoiceDate).toLocaleDateString():"N/A",amount:v,currency:s.currency||"USD",status:{tooltip:"Pending",color:"danger"}}});N(a),f(C(a,"invoice")),l(C(a,"invoice").slice(0,c))}catch(e){console.error("Error fetching invoices:",e)}};r.useEffect(()=>{T()},[]);const P=async(e=null)=>{if(window.confirm("Are you sure want to delete selected row?"))try{if(e){await L.delete(`https://cybitbackend.onrender.com/api/estimation/${e}`);const t=u.filter(a=>a.id!==e);N(t),f(t),l(t),x([]),y(""),$.success("Estimation deleted successfully!")}else if(g.length){for(const s of g)await L.delete(`https://cybitbackend.onrender.com/api/estimation/${s.id}`);const t=g.map(s=>s.id),a=u.filter(s=>!t.includes(s.id));N(a),f(a),l(a),x([]),y(""),$.success("Estimation deleted successfully!"),p(1)}}catch(t){console.error("Error deleting invoice(s):",t),alert("Failed to delete invoice(s).")}};return r.useEffect(()=>{p(1)},[c]),r.useEffect(()=>{const e=(S-1)*c,t=e+c;l([...h.slice(e,t)])},[S,c,h]),r.useEffect(()=>{f(u.filter(e=>{var t,a,s,v,d,m,w;return((t=e.invoice)==null?void 0:t.toLowerCase().includes(i.toLowerCase()))||((a=e.name)==null?void 0:a.toLowerCase().includes(i.toLowerCase()))||((s=e.email)==null?void 0:s.toLowerCase().includes(i.toLowerCase()))||((v=e.date)==null?void 0:v.toLowerCase().includes(i.toLowerCase()))||((d=e.amount)==null?void 0:d.toString().includes(i.toLowerCase()))||((w=(m=e.status)==null?void 0:m.tooltip)==null?void 0:w.toLowerCase().includes(i.toLowerCase()))}))},[i,u]),r.useEffect(()=>{const e=C(h,b.columnAccessor);l(b.direction==="desc"?e.reverse():e),p(1)},[b]),n("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:[o(Y,{position:"top-right",reverseOrder:!1}),n("div",{className:"invoice-table",children:[n("div",{className:"mb-4.5 px-5 flex md:items-center md:flex-row flex-col gap-5",children:[n("div",{className:"flex items-center gap-2",children:[n("button",{type:"button",className:"btn btn-danger gap-2",onClick:()=>P(),children:[o(A,{}),"Delete"]}),n(G,{to:"/apps/estimation/add",className:"btn btn-primary gap-2",children:[o(H,{}),"Add New"]})]}),o("div",{className:"ltr:ml-auto rtl:mr-auto",children:o("input",{type:"text",className:"form-input w-auto",placeholder:"Search...",value:i,onChange:e=>y(e.target.value)})})]}),o("div",{className:"datatables pagination-padding",children:o(_,{className:"whitespace-nowrap table-hover invoice-table",records:k,columns:[{accessor:"invoice",sortable:!0,render:({invoice:e})=>o(I,{to:"/apps/estimation/preview",children:o("div",{className:"text-primary underline hover:no-underline font-semibold",children:`#${e}`})})},{accessor:"name",sortable:!0,render:({name:e,id:t})=>o("div",{className:"flex items-center font-semibold",children:o("div",{children:e})})},{accessor:"email",sortable:!0},{accessor:"date",sortable:!0},{accessor:"amount",sortable:!0,titleClassName:"text-right",render:({amount:e,currency:t})=>n("div",{className:"text-right font-semibold",children:[B[t]||t||"$",e]})},{accessor:"status",sortable:!0,render:({status:e})=>o("span",{className:`badge badge-outline-${(e==null?void 0:e.color)||"default"}`,children:(e==null?void 0:e.tooltip)||"N/A"})},{accessor:"action",title:"Actions",sortable:!1,textAlignment:"center",render:({id:e})=>n("div",{className:"flex gap-4 items-center w-max mx-auto",children:[o(I,{to:`/apps/estimation/edit/${e}`,className:"flex hover:text-info",children:o(O,{className:"w-4.5 h-4.5"})}),o("button",{type:"button",className:"flex hover:text-danger",onClick:()=>P(e),children:o(A,{})})]})}],highlightOnHover:!0,totalRecords:h.length,recordsPerPage:c,page:S,onPageChange:e=>p(e),recordsPerPageOptions:E,onRecordsPerPageChange:D,sortStatus:b,onSortStatusChange:z,selectedRecords:g,onSelectedRecordsChange:x,paginationText:({from:e,to:t,totalRecords:a})=>`Showing  ${e} to ${t} of ${a} entries`})})]})]})};export{ee as default};
