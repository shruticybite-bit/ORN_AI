import{b as w,c as W,u as Z,r as s,s as ee,j as l,a as e,P as te,d as le,f as ae,D as se,g as L}from"./index-32628024.js";import{S as E}from"./sweetalert2.all-8934cfa7.js";import{l as re}from"./quill.snow-8d6befb7.js";import{I as ie}from"./IconClipboardText-b3362188.js";import{I as ne}from"./IconListCheck-6e1221e0.js";import{I as oe}from"./IconPlus-617eb9f3.js";import{I as ce}from"./IconHorizontalDots-5c4036e2.js";import{F as de}from"./index-537796fb.js";import{Y as p,y}from"./transition-82714c89.js";import"./_baseIsEqual-9fe87f4b.js";import"./keyboard-1a63f473.js";import"./open-closed-bc0eb11d.js";import"./hidden-7f89c524.js";const N="https://cybitbackend.onrender.com/api",me=()=>w.get(`${N}/blogs`),ue=c=>w.post(`${N}/blogs`,c),pe=(c,h)=>w.put(`${N}/blogs/${c}`,h),he=c=>w.delete(`${N}/blogs/${c}`),Pe=()=>{const c=W();Z(t=>t.themeConfig.rtlClass==="rtl");const h={id:"",title:"",description:"",descriptionText:"",image:null,priority:"low",tag:""},[T,k]=s.useState([]),[B,_]=s.useState([]),[H,f]=s.useState([]),[r,g]=s.useState(h),[$,C]=s.useState(null),[U,b]=s.useState(!1),[R,x]=s.useState(!1),[u,Y]=s.useState(h),[M,q]=s.useState(""),[d,V]=s.useState(""),[v,S]=s.useState(!1),[i]=s.useState({currentPage:1,totalPages:0,pageSize:10,startIndex:0,endIndex:0});s.useEffect(()=>{c(ee("Blogs")),I()},[]);const I=async()=>{try{const t=await me();t.data.success?(k(t.data.data),f(t.data.data),j(t.data.data)):(k([]),f([]))}catch(t){console.error(t),k([]),f([])}},K=t=>{const{value:a,id:o}=t.target;g({...r,[o]:a})},O=t=>{if(t.target.files&&t.target.files[0]){g({...r,image:t.target.files[0]});const a=new FileReader;a.onload=()=>C(a.result),a.readAsDataURL(t.target.files[0])}},P=(t=!0)=>{t&&(i.currentPage=1);let a=T.filter(n=>n.status!=="trash");["complete","important","trash"].includes(d)?a=T.filter(n=>n.status===d):["team","update"].includes(d)?a=a.filter(n=>n.tag===d):["high","medium","low"].includes(d)&&(a=a.filter(n=>n.priority===d));const o=a.filter(n=>{var A;return(A=n.title)==null?void 0:A.toLowerCase().includes(M.toLowerCase())});f(o),j(o)},j=t=>{if(!t.length){_([]),i.startIndex=-1,i.endIndex=-1;return}i.totalPages=Math.ceil(t.length/i.pageSize),i.currentPage>i.totalPages&&(i.currentPage=1),i.startIndex=(i.currentPage-1)*i.pageSize,i.endIndex=Math.min(i.startIndex+i.pageSize-1,t.length-1),_(t.slice(i.startIndex,i.endIndex+1))},X=t=>{const a=H.map(o=>o._id===t._id?{...o,status:o.status==="complete"?"":"complete"}:o);f(a),P(!1)},D=(t=null)=>{S(!1),t?(g({...t}),C(t.path?`/images/${t.path}`:null)):(g(h),C(null)),b(!0)},G=t=>{Y(t),x(!0)},m=(t,a)=>{E.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,icon:t,title:a})},[F,z]=s.useState(!1),J=async()=>{if(!r.title||!r.title.trim())return m("warning","Title is required!");if(!r.descriptionText||!r.descriptionText.trim())return m("warning","Description is required!");try{z(!0);const t=new FormData;t.append("title",r.title),t.append("description",r.description),r.image&&t.append("image",r.image),r._id?(await pe(r._id,t),m("success","Blog updated successfully!")):(await ue(t),m("success","Blog added successfully!")),b(!1),I()}catch(t){console.error(t),m("error","Something went wrong. Try again!")}finally{z(!1)}},Q=async t=>{try{(await E.fire({title:"Are you sure?",text:"This blog will be permanently deleted!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed&&(await he(t._id),I(),m("success","Blog deleted successfully!"))}catch(a){console.error(a),m("error","Failed to delete blog!")}};return l("div",{className:"flex gap-5 relative sm:h-[calc(100vh_-_150px)] h-full",children:[e(de,{position:"top-right",reverseOrder:!1}),e("div",{className:`panel p-4 flex-none w-[240px] max-w-full absolute xl:relative z-10 space-y-4 xl:h-auto h-full xl:block ltr:xl:rounded-r-md ltr:rounded-r-none rtl:xl:rounded-l-md rtl:rounded-l-none hidden ${v&&"!block"}`,children:l("div",{className:"flex flex-col h-full pb-16",children:[l("div",{className:"pb-5 flex text-center items-center",children:[e(ie,{}),e("h3",{className:"text-lg font-semibold ltr:ml-3 rtl:mr-3",children:"Blog List"})]}),e("div",{className:"h-px w-full border-b border-white-light dark:border-[#1b2e4b] mb-5"}),e(te,{className:"relative ltr:pr-3.5 rtl:pl-3.5 ltr:-mr-3.5 rtl:-ml-3.5 h-full grow",children:e("div",{className:"space-y-1",children:l("button",{type:"button",className:`w-full flex justify-between items-center p-2 rounded-md font-medium h-10 ${d===""?"bg-gray-100 dark:text-primary text-primary dark:bg-[#181F32]":""}`,onClick:()=>{V(""),P()},children:[l("div",{className:"flex items-center",children:[e(ne,{className:"w-4.5 h-4.5 shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Inbox"})]}),e("div",{className:"bg-primary-light dark:bg-[#060818] rounded-md py-0.5 px-2 font-semibold whitespace-nowrap",children:T.filter(t=>t.status!=="trash").length})]})})}),e("div",{className:"ltr:left-0 rtl:right-0 absolute bottom-0 p-4 w-full",children:l("button",{className:"btn btn-primary w-full",onClick:()=>D(),children:[e(oe,{className:"ltr:mr-2 rtl:ml-2 shrink-0"}),"Add New Blog"]})})]})}),e("div",{className:`overlay bg-black/60 z-[5] w-full h-full rounded-md absolute hidden ${v&&"!block xl:!hidden"}`,onClick:()=>S(!v)}),e("div",{className:"panel p-0 flex-1 overflow-auto h-full",children:l("div",{className:"flex flex-col h-full",children:[e("div",{className:"p-4 flex sm:flex-row flex-col w-full sm:items-center gap-4",children:l("div",{className:"ltr:mr-3 rtl:ml-3 flex items-center flex-1",children:[e("button",{type:"button",className:"xl:hidden hover:text-primary",onClick:()=>S(!v),children:e(le,{})}),l("div",{className:"relative flex-1",children:[e("input",{type:"text",className:"form-input peer ltr:!pr-10 rtl:!pl-10",placeholder:"Search Task...",value:M,onChange:t=>q(t.target.value),onKeyUp:()=>P()}),e("div",{className:"absolute ltr:right-[11px] rtl:left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-primary",children:e(ae,{})})]})]})}),e("div",{className:"table-responsive grow overflow-y-auto sm:min-h-[300px] min-h-[400px]",children:B.length?e("table",{className:"table-hover w-full",children:e("tbody",{children:B.map(t=>l("tr",{className:"group cursor-pointer",children:[e("td",{className:"w-1",children:e("input",{type:"checkbox",className:"form-checkbox",onClick:()=>X(t),defaultChecked:t.status==="complete"})}),l("td",{onClick:()=>G(t),children:[e("div",{className:`font-semibold ${t.status==="complete"?"line-through":""}`,children:t.title}),e("div",{className:`text-gray-600 line-clamp-2 ${t.status==="complete"?"line-through":""}`,dangerouslySetInnerHTML:{__html:t.description}})]}),e("td",{children:e("div",{className:"dropdown",children:e(se,{button:e(ce,{}),children:l("ul",{children:[e("li",{children:e("button",{onClick:()=>D(t),children:"Edit"})}),e("li",{children:e("button",{onClick:()=>Q(t),children:"Delete"})})]})})})})]},t._id))})}):e("div",{className:"flex justify-center items-center font-semibold text-lg min-h-[300px]",children:"No data available"})})]})}),e(p,{appear:!0,show:U,as:s.Fragment,children:l(y,{as:"div",className:"relative z-[51]",onClose:()=>b(!1),children:[e(p.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(p.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:l(y.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:()=>b(!1),className:"absolute top-4 ltr:right-4 rtl:left-4",children:e(L,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:r.id?"Edit Blog":"Add Blog"}),l("div",{className:"p-5",children:[l("div",{className:"mb-5",children:[e("label",{children:"Title"}),e("input",{id:"title",type:"text",className:"form-input",value:r.title,onChange:K})]}),l("div",{className:"mb-5",children:[e("label",{children:"Image"}),e("input",{type:"file",accept:"image/*",onChange:O}),$&&e("img",{src:$,className:"h-32 w-32 object-cover rounded-md mt-2",alt:"Preview"})]}),l("div",{className:"mb-5",children:[e("label",{children:"Description"}),e(re,{theme:"snow",value:r.description,onChange:(t,a,o,n)=>g({...r,description:t,descriptionText:n.getText()}),style:{minHeight:"200px"}})]}),l("div",{className:"flex justify-end gap-2 mt-4",children:[e("button",{className:"btn btn-outline-danger",onClick:()=>b(!1),children:"Cancel"}),e("button",{className:`btn btn-primary ${F?"opacity-50 cursor-not-allowed":""}`,onClick:J,disabled:F,children:F?"Saving...":r.id?"Update":"Add"})]})]})]})})})})]})}),e(p,{appear:!0,show:R,as:s.Fragment,children:l(y,{as:"div",className:"relative z-[51]",onClose:()=>x(!1),children:[e(p.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(p.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:l(y.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:()=>x(!1),className:"absolute top-4 ltr:right-4 rtl:left-4",children:e(L,{})}),l("div",{className:"flex items-center flex-wrap gap-2 text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3",children:[e("div",{children:u.title}),u.priority&&e("div",{className:"badge",children:u.priority}),u.tag&&e("div",{className:"badge",children:u.tag})]}),l("div",{className:"p-5",children:[e("div",{dangerouslySetInnerHTML:{__html:u.description}}),e("div",{className:"flex justify-end mt-4",children:e("button",{className:"btn btn-outline-danger",onClick:()=>x(!1),children:"Close"})})]})]})})})})]})})]})};export{ue as addBlog,Pe as default,he as deleteBlog,me as fetchBlogs,pe as updateBlog};
