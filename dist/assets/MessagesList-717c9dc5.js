import{r as l,j as a,F as w,a as t,b as v}from"./index-4f69de9b.js";const N="#";function M(){const[s,S]=l.useState(""),[m,p]=l.useState(""),[i,g]=l.useState([]),[c,h]=l.useState([]),[d,u]=l.useState(!1),x=l.useRef(null),k=()=>{new Audio("https://assets.mixkit.co/sfx/download/mixkit-message-pop-alert-2354.mp3").play().catch(()=>{})},C=()=>{var e;(e=x.current)==null||e.scrollIntoView({behavior:"smooth"})};l.useEffect(C,[i]);const f=async()=>{if(s)try{const n=(await v.get(`${N}?email=${s}`)).data||[];n.length>i.length&&k(),g(n)}catch(e){console.error("Fetch failed:",e)}};l.useEffect(()=>{if(!d)return;const e=setInterval(f,5e3);return()=>clearInterval(e)},[s,d,i.length]);const b=async()=>{if(!(!m.trim()&&c.length===0)){if(!s.trim())return alert("Please enter email to start chat");try{const e={message:m,email:s,attachments:c},o={...(await v.post(N,e)).data,sender:"guest",userName:s,timestamp:new Date().toISOString()};g(r=>[...r,o]),p(""),h([])}catch(e){console.error("Send error:",e)}}},E=e=>{const o=Array.from(e.target.files).map(r=>({name:r.name,url:URL.createObjectURL(r)}));h(r=>[...r,...o])},j=e=>h(n=>n.filter(o=>o.name!==e));return a(w,{children:[!d&&t("button",{onClick:()=>u(!0),className:"fixed bottom-6 right-6 bg-indigo-600 text-white py-3 px-5 rounded-full shadow-lg z-[99999] hover:bg-indigo-700 transition-all flex items-center gap-2",children:"ðŸ’¬ Support"}),d&&a("div",{className:"fixed bottom-6 right-6 w-96 max-w-[90vw] h-[500px] bg-white rounded-2xl shadow-2xl border border-gray-200 flex flex-col z-[999999] transition-all",style:{animation:"popIn 0.25s ease-out"},children:[a("div",{className:"bg-indigo-600 text-white flex justify-between items-center px-4 py-3 rounded-t-2xl",children:[t("h3",{className:"font-semibold",children:"ðŸ’¬ Support Chat"}),t("button",{onClick:()=>u(!1),className:"text-white text-lg hover:opacity-75",children:"âœ•"})]}),!s&&a("div",{className:"p-4 flex flex-col gap-3",children:[t("p",{className:"text-sm text-gray-600",children:"Enter your email to start chatting:"}),t("input",{type:"email",value:s,onChange:e=>S(e.target.value),placeholder:"your@email.com",className:"border rounded-lg p-2 text-sm focus:outline-indigo-500 text-black"}),t("button",{onClick:()=>s&&f(),className:"bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition",children:"Start Chat"})]}),s&&a(w,{children:[a("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-3 space-y-3",children:[i.length===0&&t("p",{className:"text-center text-gray-400 text-sm",children:"No messages yet..."}),i.map((e,n)=>{var r;const o=e.sender==="guest";return t("div",{className:`flex ${o?"justify-end":"justify-start"}`,children:a("div",{className:`max-w-[75%] p-3 rounded-2xl shadow ${o?"bg-indigo-100 text-black rounded-br-none":"bg-gray-200 text-black rounded-bl-none"}`,children:[((r=e.attachments)==null?void 0:r.length)>0&&t("div",{className:"space-y-1 mb-1",children:e.attachments.map((y,I)=>a("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 text-xs underline block",children:["ðŸ“Ž ",y.split("/").pop()]},I))}),t("p",{children:e.message}),t("span",{className:"block text-[10px] text-gray-600 text-right mt-1",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},n)}),t("div",{ref:x})]}),c.length>0&&t("div",{className:"bg-gray-100 p-2 flex gap-2 overflow-x-auto",children:c.map((e,n)=>a("div",{className:"flex items-center gap-1 bg-white border rounded-md px-2 py-1 text-xs shadow",children:[t("span",{children:e.name}),t("button",{onClick:()=>j(e.name),className:"text-red-500",children:"âœ•"})]},n))}),a("div",{className:"p-3 border-t bg-white flex items-center gap-2",children:[a("label",{className:"cursor-pointer text-xl",children:["ðŸ“Ž",t("input",{type:"file",multiple:!0,className:"hidden",onChange:E})]}),t("input",{type:"text",placeholder:"Type your message...",value:m,onChange:e=>p(e.target.value),onKeyDown:e=>e.key==="Enter"&&b(),className:"flex-1 border rounded-lg px-3 py-2 text-sm text-black focus:outline-indigo-500"}),t("button",{onClick:b,className:"bg-indigo-600 text-white px-3 py-2 rounded-lg hover:bg-indigo-700 transition",children:"âž¤"})]})]})]}),t("style",{children:`
        @keyframes popIn {
          from { transform: scale(0.8); opacity: 0; }
          to { transform: scale(1); opacity: 1; }
        }
      `})]})}export{M as default};
