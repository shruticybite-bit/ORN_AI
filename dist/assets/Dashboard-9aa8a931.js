import{r as c,u as x,j as s,a as e,L as C,D as w}from"./index-4f69de9b.js";import{_ as N}from"./react-apexcharts.min-89463aad.js";import{I as S}from"./IconHorizontalDots-fe9a0b79.js";import j from"./MessagesList-717c9dc5.js";const F=({userId:b})=>{const[f,u]=c.useState(!0),[D,g]=c.useState([0,0]),[l,y]=c.useState({series:[{name:"Count",data:[0,0]}],options:{chart:{id:"revenue-chart",toolbar:{show:!0}},colors:["#22C55E","#EF4444"],xaxis:{categories:["Payments","Instances"]}}});x(t=>t.themeConfig.theme==="dark"||t.themeConfig.isDarkMode);const p=t=>{var n;const r=`; ${document.cookie}`.split(`; ${t}=`);if(r.length===2)return(n=r.pop())==null?void 0:n.split(";").shift()},i=JSON.parse(localStorage.getItem("userId")||"{}");console.log("user=",i);const d=p("access"),k=async()=>{try{const t=p("refresh"),r=await(await fetch("#",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:t})})).json();return r.access?(document.cookie=`access=${r.access}; path=/`,r.access):null}catch(t){return console.error("Failed to refresh token",t),null}};return c.useEffect(()=>{(async()=>{u(!0);let o=d;if(!o&&(o=await k(),!o))return;const r=[{url:`#${i}/`,name:"Payments"},{url:`#${i}/`,name:"Instances"}],n=["rgba(52,152,219,0.7)","rgba(46,204,113,0.7)","rgba(231,76,60,0.7)","rgba(155,89,182,0.7)","rgba(241,196,15,0.7)","rgba(230,126,34,0.7)"],v=n.map(a=>a.replace("0.7","1"));try{const a=await Promise.all(r.map(async h=>{try{return(await(await fetch(h.url,{headers:{Authorization:`Bearer ${d}`}})).json()).count??0}catch{return 0}}));g(a),y({...l,series:[{name:"Count",data:a}],options:{...l.options,colors:["#22C55E","#EF4444"]}});const m=document.getElementById("progressChart");m&&new Chart(m,{type:"bar",data:{labels:r.map(h=>h.name),datasets:[{label:"Total Count",data:a,backgroundColor:n,borderColor:v,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}catch(a){console.error(a)}finally{u(!1)}})()},[b,d]),s("div",{children:[s("ul",{className:"flex space-x-2 rtl:space-x-reverse",children:[e("li",{children:e(C,{to:"/",className:"text-primary hover:underline",children:"Dashboard"})}),e("li",{className:"before:content-['/'] ltr:before:mr-2 rtl:before:ml-2",children:e("span",{children:"User Dashboard"})})]}),s("div",{className:"pt-5",children:[e("div",{className:"grid xl:grid-cols-3 gap-6 mb-6",children:s("div",{className:"panel h-full xl:col-span-2",children:[s("div",{className:"flex items-center justify-between dark:text-white-light mb-5",children:[e("h5",{className:"font-semibold text-lg"}),e("div",{className:"dropdown",children:e(w,{offset:[0,1],placement:"bottom-end",button:e(S,{className:"text-black/70 dark:text-white/70 hover:!text-primary"}),children:s("ul",{children:[e("li",{children:e("button",{type:"button",children:"Weekly"})}),e("li",{children:e("button",{type:"button",children:"Monthly"})}),e("li",{children:e("button",{type:"button",children:"Yearly"})})]})})})]}),e("div",{className:"relative",children:e("div",{className:"bg-white dark:bg-black rounded-lg overflow-hidden",children:f?e("div",{className:"min-h-[325px] grid place-content-center bg-white-light/30 dark:bg-dark dark:bg-opacity-[0.08] ",children:e("span",{className:"animate-spin border-2 border-black dark:border-white !border-l-transparent  rounded-full w-5 h-5 inline-flex"})}):e(N,{series:l.series,options:l.options,type:"area",height:325})})})]})}),e("div",{className:"grid sm:grid-cols-2 xl:grid-cols-3 gap-6 mb-6",children:e("div",{className:"panel h-full p-0"})})]}),e(j,{})]})};export{F as default};
