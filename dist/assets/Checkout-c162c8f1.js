import{i as g,l as b,r as v,a as c,j as h,b as d}from"./index-32628024.js";const u="#",P=()=>new Promise(t=>{if(typeof document>"u")return t(!1);if(document.querySelector('script[src="https://checkout.razorpay.com/v1/checkout.js"]'))return t(!0);const s=document.createElement("script");s.src="https://checkout.razorpay.com/v1/checkout.js",s.onload=()=>t(!0),s.onerror=()=>t(!1),document.body.appendChild(s)}),l=async t=>{try{return(await d.post(`${u}/users/create-order/`,{amount:t})).data}catch(a){return console.error("payRazorApi error:",a),null}};l.verifyPayment=async t=>{try{return(await d.post(`${u}/users/verify-payment/`,t)).data}catch(a){return console.error("verifyPayment error:",a),{success:!1}}};const k=async t=>{try{return(await d.post(`${u}/users/deploy/${t}/`)).data}catch(a){return console.error("createInstanceApi error:",a),null}},N=()=>{var f;const t=g(),s=((f=b().state)==null?void 0:f.cartItems)||[],[p,n]=v.useState(!1),r=s.length>0?s[0]:null,w=async()=>{if(!r){alert("Cart is empty!");return}n(!0);try{if(r.billingType==="free"){await y(r.planId);return}if(!await P()){alert("Failed to load Razorpay"),n(!1);return}const e=await l(r.price);if(!(e!=null&&e.id)){alert("Unable to initialize payment."),n(!1);return}const x={key:e.key_id,amount:e.amount,currency:e.currency,name:"OnRequestLab",description:r.name,order_id:e.id,handler:async i=>{(await l.verifyPayment(i)).success?await y(r.planId):(alert("Payment verification failed!"),n(!1))},modal:{ondismiss:()=>{alert("Payment cancelled"),n(!1)}}},m=new window.Razorpay(x);m.on("payment.failed",i=>{alert("Payment failed: "+i.error.description),n(!1)}),m.open()}catch(o){console.error(o),alert("Something went wrong!"),n(!1)}},y=async o=>{try{const e=await k(o);e!=null&&e.web_ssh_url?window.location.href=e.web_ssh_url:t("/instances")}catch(e){console.error(e),alert("Failed to launch instance.")}finally{n(!1)}};return c("div",{className:"min-h-screen flex justify-center items-center bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 px-4 py-16",children:h("div",{className:"max-w-md w-full bg-gray-800 rounded-2xl p-8 shadow-2xl space-y-6",children:[c("h2",{className:"text-3xl font-bold text-center text-white",children:"Checkout"}),h("p",{className:"text-center text-lg text-gray-300",children:["Total: â‚¹",(r==null?void 0:r.price)||0]}),c("button",{onClick:w,disabled:p||!r,className:"w-full py-4 rounded-xl bg-gradient-to-r from-purple-500 to-blue-500 text-white font-semibold text-lg shadow-lg hover:scale-105 transform transition-all",children:p?"Processing...":"Pay & Launch"}),!r&&c("p",{className:"text-center text-red-500",children:"No items in your cart."})]})})};export{N as default};
