import{r as h,i as P,j as t,a,b}from"./index-4f69de9b.js";import{C as d}from"./check-888c02f6.js";import"./createLucideIcon-d8510d22.js";const C=()=>{const[l,m]=h.useState("monthly"),[p,i]=h.useState(!1),u=P(),n=JSON.parse(localStorage.getItem("user")),o=localStorage.getItem("token"),f={monthly:499,yearly:4999},x=async()=>{i(!0);try{return(await b.post("#",{planType:l},{headers:{Authorization:`Bearer ${o}`}})).data}catch{return alert("Failed to create subscription order."),i(!1),null}},g=e=>new Promise((s,r)=>{const c={key:"rzp_test_xxxxx",amount:e.amount,currency:"INR",name:"OnRequest Lab",description:"Subscription Payment",order_id:e.order_id,handler:function(S){s(S)},prefill:{name:n==null?void 0:n.name,email:n==null?void 0:n.email},theme:{color:"#4f46e5"}},y=new window.Razorpay(c);y.on("payment.failed",()=>r("Payment failed")),y.open()}),N=async(e,s)=>{try{return(await b.post("#",{...e,order_id:s},{headers:{Authorization:`Bearer ${o}`}})).data}catch{return alert("Payment verification failed!"),null}},w=async()=>{if(!o)return alert("Session expired! Please login again."),u("/login");const e=await x();if(!e)return;let s;try{s=await g(e)}catch(c){alert(c),i(!1);return}const r=await N(s,e.order_id);r!=null&&r.success?(alert("Subscription activated successfully!"),u("/dashboard")):alert("Verification failed."),i(!1)};return t("div",{className:"p-6 max-w-3xl mx-auto",children:[a("h2",{className:"text-2xl font-bold mb-4",children:"Choose Your Plan"}),t("div",{className:"flex gap-4 mb-6",children:[a("button",{className:`px-4 py-2 rounded ${l==="monthly"?"bg-blue-600 text-white":"bg-gray-200"}`,onClick:()=>m("monthly"),children:"Monthly"}),a("button",{className:`px-4 py-2 rounded ${l==="yearly"?"bg-blue-600 text-white":"bg-gray-200"}`,onClick:()=>m("yearly"),children:"Yearly"})]}),t("div",{className:"border p-6 rounded-xl shadow",children:[a("h3",{className:"text-xl font-semibold mb-2",children:l==="monthly"?"Monthly Subscription":"Yearly Subscription"}),t("p",{className:"text-3xl font-bold mb-4",children:["â‚¹",f[l]]}),t("ul",{className:"mb-4 space-y-2",children:[t("li",{className:"flex items-center gap-2",children:[a(d,{size:18})," Unlimited Labs"]}),t("li",{className:"flex items-center gap-2",children:[a(d,{size:18})," Priority Support"]}),t("li",{className:"flex items-center gap-2",children:[a(d,{size:18})," Free Updates"]})]}),a("button",{disabled:p,onClick:w,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg",children:p?"Processing...":"Buy Now"})]})]})};export{C as default};
