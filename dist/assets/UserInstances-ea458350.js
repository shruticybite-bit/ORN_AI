import{i as R,r as t,j as n,F as $,a,k as T,b as i,y as H}from"./index-365972c4.js";import{N as D,F as M}from"./Footer-c50aecf8.js";import"./createLucideIcon-9e7f1bc4.js";const u="#",c=(h,f="info")=>{H[f](h,{position:"top-center",autoClose:2500})},K=()=>{R(),t.useState("monthly");const[h,f]=t.useState([]),[C,b]=t.useState(!1);t.useState(!1),t.useState(()=>{try{const e=localStorage.getItem("orl_cart");return e?JSON.parse(e):[]}catch{return[]}});const[U,y]=t.useState(null),[q,w]=t.useState(null),[J,S]=t.useState(!1);t.useState(!1),t.useState(!1),t.useState(!1),t.useState(""),t.useState(null),t.useState(!1);const N=t.useRef(null),[v,k]=t.useState(""),[p,L]=t.useState(1),g=10,d=e=>{if(typeof document>"u")return"";const o=`; ${document.cookie}`.split(`; ${e}=`);return o.length===2?o.pop().split(";").shift():""},P=d("access"),_=d("user_id"),A=localStorage.getItem("jwt-auth")||localStorage.getItem("access")||localStorage.getItem("token")||"",r=(P||A||"").trim();d("username"),d("email");const m=h.filter(e=>(e.instance_name||e.user_instance_id||"").toLowerCase().includes(v.toLowerCase())),B=Math.ceil(m.length/g),F=m.slice((p-1)*g,p*g),j=async()=>{var e,s;S(!0);try{const o=await i.get(`${u}/users/wallet/balance/`,{headers:{Authorization:`Bearer ${r}`}}),l=((e=o.data)==null?void 0:e.balance)??((s=o.data)==null?void 0:s.wallet_amount)??o.data;w(typeof l=="object"?l.balance??null:l)}catch{w(null)}finally{S(!1)}};t.useEffect(()=>{r&&j()},[r]);const x=async()=>{if(!(!r||!_)){b(!0);try{let s=(await i.get(`${u}/lab/userinst/${_}/`,{headers:{Authorization:`Bearer ${r}`}})).data||[];s.sort((l,I)=>l.status==="Launched"&&I.status!=="Launched"?-1:I.status==="Launched"&&l.status!=="Launched"?1:0),f(s);const o=s.find(l=>l.status==="Launched");y(o&&o.webssh_url||null)}catch{}finally{b(!1)}}};t.useEffect(()=>{if(!r)return;x();const e=setInterval(x,3e4);return()=>clearInterval(e)},[r]);const W=e=>{if(!navigator.clipboard)return c("Clipboard not available","error");navigator.clipboard.writeText(e),c("Copied to clipboard","success")},z=async e=>{if(!r){c("Please login","error");return}if(window.confirm("Are you sure you want to reboot this instance?"))try{await i.post(`${u}/users/reboot/${e}/`,{},{headers:{Authorization:`Bearer ${r}`}}),c("Reboot initiated!","success")}catch{c("Failed to reboot instance","error")}},E=async e=>{if(!r){c("Please login","error");return}if(window.confirm("Are you sure to destroy this instance?"))try{e.payment_id?await i.post(`${u}/users/deploy-experimental/destroy/`,{user_id:e.user_instance_id},{headers:{Authorization:`Bearer ${r}`}}):await i.post(`${u}/users/deploy-free/destroy/`,{user_id:e.user_instance_id},{headers:{Authorization:`Bearer ${r}`}}),c("Destroy request sent","success"),setTimeout(x,3e3)}catch{c("Failed to destroy instance","error")}};return t.useEffect(()=>()=>{N.current&&clearInterval(N.current)},[]),n($,{children:[a(D,{}),n("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 py-24 px-6",children:[a(T,{}),a("div",{className:"max-w-7xl mx-auto text-center mb-16",children:a("h1",{className:"text-5xl md:text-6xl font-extrabold tracking-tight bg-gradient-to-r from-purple-400 to-blue-300 bg-clip-text text-transparent mb-4",children:"My Instances"})}),a("div",{className:"mt-12 max-w-4xl mx-auto",children:n("div",{className:"bg-white/5 border border-white/10 rounded-xl p-6",children:[n("div",{className:"flex flex-col md:flex-row items-center justify-between mb-4 gap-4",children:[a("h3",{className:"text-white font-bold",children:"Your Instances"}),n("div",{className:"flex gap-2 items-center",children:[a("input",{type:"text",placeholder:"Search instance...",className:"px-3 py-1 rounded bg-white/10 text-white placeholder-gray-400 text-sm",value:v,onChange:e=>k(e.target.value)}),a("div",{className:"text-sm text-gray-400",children:C?"Refreshing...":`${m.length} item(s)`})]})]}),m.length===0?a("div",{className:"text-gray-400",children:"No instances match your search."}):n($,{children:[a("ul",{className:"space-y-3",children:F.map((e,s)=>n("li",{className:"bg-white/5 p-3 rounded flex flex-col md:flex-row items-start md:items-center justify-between gap-2",children:[n("div",{children:[a("div",{className:"text-white font-semibold",children:e.instance_name||e.user_instance_id||`Instance ${s+1}`}),n("div",{className:"text-gray-400 text-sm",children:["Status: ",e.status," ",e.is_free?"(Free)":""]}),e.instance_ip&&n("div",{className:"text-gray-400 text-sm",children:["IP: ",e.instance_ip]})]}),n("div",{className:"flex flex-wrap gap-2 mt-2 md:mt-0",children:[e.instance_ip&&a("button",{className:"px-3 py-1 bg-gray-800 rounded text-white text-sm",onClick:()=>W(e.instance_ip),children:"Copy IP"}),e.status==="Launched"&&a("button",{className:"px-3 py-1 bg-gradient-to-r from-purple-500 to-blue-500 rounded text-white text-sm",onClick:()=>window.open(`/lab?user=${e.userId}`,"_blank"),children:"WebSSH"}),a("button",{className:"px-3 py-1 bg-yellow-600 rounded text-white text-sm",onClick:()=>z(e.user_instance_id),children:"Reboot"}),a("button",{className:"px-3 py-1 bg-red-700 rounded text-white text-sm",onClick:()=>E(e),children:"Destroy"})]})]},s))}),a("div",{className:"flex justify-center gap-2 mt-4 flex-wrap",children:Array.from({length:B},(e,s)=>s+1).map(e=>a("button",{className:`px-3 py-1 rounded ${p===e?"bg-blue-600 text-white":"bg-white/5 text-gray-300"}`,onClick:()=>L(e),children:e},e))})]})]})})]}),a(M,{})]})};export{K as default};
